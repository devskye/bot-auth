generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "mysql"
}

model User {
  id        Int      @id @default(autoincrement())
  email     String
  idDiscord String   @unique
  ip        String
  asn       String
  createdAt DateTime @default(now())
}

model Avaliacao {
  id        Int       @id @default(autoincrement())
  nota      Int
  autorId   String
  staffId   Int
  createdAt DateTime  @default(now())
  SttsStaff SttsStaff @relation(fields: [staffId], references: [id], onDelete: Cascade)

  @@index([staffId], map: "Avaliacao_staffId_fkey")
}

model BoosterRedeem {
  id         Int      @id @default(autoincrement())
  userId     String   @unique
  redeemedAt DateTime @default(now())
  account    String

  @@unique([userId, account])
}

model Filter {
  id        Int      @id @default(autoincrement())
  type      String
  channel   String
  status    Boolean  @default(false)
  createdAt DateTime @default(now())

  @@unique([channel, type])
}

model Punishment {
  id       String   @id
  playerId Int
  playerDc String
  staff    String
  reason   String
  time     String
  url      String   @default("")
  date     DateTime @default(now())

  @@index([playerDc])
}

model RegistroPonto {
  id             Int       @id @default(autoincrement())
  staffDiscordId String
  inicio         DateTime
  fim            DateTime?
  duracao        Int?
  createdAt      DateTime  @default(now())
  SttsStaff      SttsStaff @relation(fields: [staffDiscordId], references: [discordId])

  @@index([staffDiscordId], map: "RegistroPonto_staffDiscordId_fkey")
}

model SttsStaff {
  id            Int             @id @default(autoincrement())
  discordId     String          @unique
  nome          String?
  cargo         String
  horas         Int             @default(0)
  ponto         Boolean         @default(false)
  pontoAbertoEm DateTime?
  createdAt     DateTime        @default(now())
  Avaliacao     Avaliacao[]
  RegistroPonto RegistroPonto[]
}

model Sugestao {
  authorId  String   @db.VarChar(255)
  messageId String   @id
  conteudo  String
  createdAt DateTime @default(now())
  Voto      Voto[]
}

model Ticket {
  id            String   @id
  channelId     String   @unique
  ownerId       String
  ownerUsername String
  category      String
  createdAt     DateTime
  responsavelId String?
  transcriptUrl String?  @db.Text

  @@index([ownerId])
}

model TicketHistory {
  id            Int      @id @default(autoincrement())
  ticketId      String
  responsavelId String
  assumidoEm    DateTime @default(now())
}

model Voto {
  id        Int       @id @default(autoincrement())
  messageId String
  userId    String
  type      Voto_type
  Sugestao  Sugestao  @relation(fields: [messageId], references: [messageId], onDelete: Cascade)

  @@unique([messageId, userId])
  @@index([messageId])
}

model allowProvider {
  id       Int    @id @default(autoincrement())
  provedor String @db.VarChar(255)
}

model answers {
  id          Int        @id @default(autoincrement())
  answer      String
  whitelistId Int
  questionId  Int
  questions   questions  @relation(fields: [questionId], references: [id], onDelete: Cascade)
  whitelists  whitelists @relation(fields: [whitelistId], references: [id], onDelete: Cascade)

  @@index([questionId], map: "answers_questionId_fkey")
  @@index([whitelistId], map: "answers_whitelistId_fkey")
}

model codiguins {
  id   Int    @id @default(autoincrement())
  code String @unique
}

model questions {
  id       Int       @id @default(autoincrement())
  question String
  answers  answers[]
}

model status_allowlists {
  id        Int      @id @default(autoincrement())
  userId    String   @unique
  status    String
  updatedAt DateTime
  createdAt DateTime @default(now())

  @@map("status-allowlists")
}

model whitelists {
  id           Int       @id @default(autoincrement())
  channelId    String    @unique
  userId       String    @unique
  lastquestion Int       @default(-1)
  messageId    String    @default("")
  started      Boolean   @default(false)
  approved     Boolean   @default(false)
  inReview     Boolean   @default(false)
  finalized    Boolean   @default(false)
  answers      answers[]
}

enum Voto_type {
  sim
  nao
}
